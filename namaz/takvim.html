<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Namaz Takvimi - Furkan</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .location-header { color: #10b981; font-size: 20px; font-weight: bold; margin-bottom: 15px; }
        .table-wrapper { background: #1e293b; border-radius: 20px; padding: 5px; overflow-x: auto; }
        table { width: 100%; border-collapse: collapse; color: #f8fafc; min-width: 450px; }
        th { background: #0f172a; color: #94a3b8; padding: 10px; font-size: 11px; text-transform: uppercase; }
        td { padding: 12px; text-align: center; border-bottom: 1px solid #334155; font-size: 14px; }
        .today-row { background: rgba(16, 185, 129, 0.2); color: #10b981; font-weight: bold; }
    </style>
</head>
<body>

<div class="mobile-container">
    <div class="app-header">
        <h1>Namaz Takvimi</h1>
        <div id="location-display" class="location-header">YÃ¼kleniyor...</div>
    </div>

    <div class="table-wrapper">
        <table>
            <thead>
                <tr>
                    <th>Tarih</th>
                    <th>Ä°msak</th>
                    <th>Ã–ÄŸle</th>
                    <th>Ä°kindi</th>
                    <th>AkÅŸam</th>
                    <th>YatsÄ±</th>
                </tr>
            </thead>
            <tbody id="calendar-body"></tbody>
        </table>
    </div>

    <button class="btn-primary" style="background:#334155; margin-top:15px;" onclick="window.history.back()">â¬… Geri DÃ¶n</button>
</div>

<script>
    const params = new URLSearchParams(window.location.search);
    const id = params.get('id');
    const locName = params.get('name');

    // Ä°smi hemen ekrana yaz
    if(locName) document.getElementById('location-display').innerText = "ðŸ“ " + locName;

    if(id) {
        fetch(`api/vakitler/${id}.json`)
            .then(res => res.json())
            .then(data => {
                let html = '';
                const bugun = new Date().toLocaleDateString('tr-TR');
                const limit = new Date(2026, 2, 11); // 10 Mart dahil

                data.forEach(v => {
                    const p = v.MiladiTarihKisa.split('.');
                    const vDate = new Date(p[2], p[1]-1, p[0]);

                    if (vDate < limit) {
                        const isToday = v.MiladiTarihKisa === bugun ? 'class="today-row"' : '';
                        html += `<tr ${isToday}>
                            <td>${v.MiladiTarihKisa.split('.')[0]} ${v.KameriTarihKisa.split(' ')[1]}</td>
                            <td>${v.Imsak}</td>
                            <td>${v.Ogle}</td>
                            <td>${v.Ikindi}</td>
                            <td>${v.Aksam}</td>
                            <td>${v.Yatsi}</td>
                        </tr>`;
                    }
                });
                document.getElementById('calendar-body').innerHTML = html;
            });
    }
</script>
</body>
</html>
