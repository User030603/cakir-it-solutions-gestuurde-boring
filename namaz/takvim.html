<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Namaz Takvimi - Furkan</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .location-header { color: #10b981; font-size: 20px; font-weight: bold; margin-bottom: 15px; text-align: center; }
        .table-wrapper { background: #1e293b; border-radius: 20px; padding: 5px; overflow-x: auto; margin-bottom: 20px; }
        table { width: 100%; border-collapse: collapse; color: #f8fafc; min-width: 450px; }
        th { background: #0f172a; color: #94a3b8; padding: 10px; font-size: 11px; text-transform: uppercase; }
        td { padding: 12px; text-align: center; border-bottom: 1px solid #334155; font-size: 14px; }
        .today-row { background: rgba(16, 185, 129, 0.3) !important; color: #10b981; font-weight: bold; }
    </style>
</head>
<body>

<div class="mobile-container">
    <div class="app-header">
        <h1>Namaz Takvimi</h1>
        <div id="location-display" class="location-header">Y√ºkleniyor...</div>
    </div>

    <div class="table-wrapper">
        <table>
            <thead>
                <tr>
                    <th>Tarih</th>
                    <th>ƒ∞msak</th>
                    <th>√ñƒüle</th>
                    <th>ƒ∞kindi</th>
                    <th>Ak≈üam</th>
                    <th>Yatsƒ±</th>
                </tr>
            </thead>
            <tbody id="calendar-body">
                </tbody>
        </table>
    </div>

    <button class="btn-primary" style="background:#334155;" onclick="window.location.href='index.html'">‚¨Ö Geri D√∂n</button>
</div>

<script>
    const params = new URLSearchParams(window.location.search);
    const id = params.get('id');
    const locName = params.get('name');

    if(locName) document.getElementById('location-display').innerText = "üìç " + locName;

    if(id) {
        // Dosyayƒ± √ßekiyoruz
        fetch(`api/vakitler/${id}.json`)
            .then(res => {
                if(!res.ok) throw new Error(`Dosya bulunamadƒ±: ${id}.json`);
                return res.json();
            })
            .then(data => {
                let html = '';
                // Bug√ºn√ºn tarihini g√ºn/ay/yƒ±l formatƒ±nda al (√ñrn: 10.02.2026)
                const now = new Date();
                const bugun = now.toLocaleDateString('tr-TR', {day: '2-digit', month: '2-digit', year: 'numeric'});

                data.forEach(v => {
                    // JSON'daki tarih ile bug√ºn√º kƒ±yasla
                    const isToday = v.MiladiTarihKisa === bugun ? 'class="today-row"' : '';
                    
                    html += `<tr ${isToday}>
                        <td>${v.MiladiTarihKisa}<br><small>${v.MiladiTarihUzun.split(' ')[2]}</small></td>
                        <td>${v.Imsak}</td>
                        <td>${v.Ogle}</td>
                        <td>${v.Ikindi}</td>
                        <td>${v.Aksam}</td>
                        <td>${v.Yatsi}</td>
                    </tr>`;
                });
                document.getElementById('calendar-body').innerHTML = html;
            })
            .catch(err => {
                document.getElementById('location-display').innerHTML = 
                    `<div style="color:#ef4444; font-size:14px;">‚ö†Ô∏è Hata: Veri y√ºklenemedi!<br>${err.message}</div>`;
            });
    }
</script>
</body>
</html>
